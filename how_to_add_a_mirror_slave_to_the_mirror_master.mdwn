This will be of interest only to admins who run a Libravatar master server using the <tt>libravatar-master</tt> package and who want to add a new slave.

# Initial setup

Do this on the **slave**:

1. make sure NTP is installed and running
1. install the required packages on the slave:

        dpkg -i libravatar-{common,cdn-common,cdn,seccdn,slave}*.deb
        apt-get install -f

2. create symlinks for the SSL certificate:

        ln -s /var/lib/libravatar/slave/cert/seccdn-chain.pem /etc/libravatar/
        ln -s /var/lib/libravatar/slave/cert/seccdn.pem /etc/libravatar/
        ln -s /var/lib/libravatar/slave/cert/seccdn.crt /etc/libravatar/

3. uncomment <tt>allowrsync</tt> in <tt>/etc/rssh.conf</tt>.
4. (optional) make the statistical reports available:

        apt-get install awstats
        ln -s /usr/share/awstats/icon/ /var/www/awstats-icon
        ln -s /var/cache/awstats/ /var/www/stats

Do this on the **master**:

1. add the slave's ssh hostkey to known_keys:

        sudo -u libravatar-master ssh libravatar-slave@mirror1.example.com

2. add the mirror hostname to <tt>/etc/default/libravatar-master</tt>

Within about 15 minutes, you should see these files pop up on the slave:

* <tt>/var/lib/libravatar/slave/cert/chain.pem</tt>
* <tt>/var/lib/libravatar/slave/cert/seccdn.pem</tt>
* <tt>/var/lib/libravatar/slave/cert/seccdn.crt</tt>

Then you can restart Apache on the slave to enable everything.

# Testing the new mirror

Given a new slave with an IP address of 192.0.2.10, then you can put this in your local <tt>/etc/hosts</tt>:

    192.0.2.10    cdn.libravatar.org seccdn.libravatar.org

and then lookup images using the [test tool](http://www.libravatar.org/tools/check).

Once it works, add the new slave to the round-robin A (and hopefully AAAA) records in your zone.
